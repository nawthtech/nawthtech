name = "nawthtech-api"
main = "worker/src/main.go" # الملف الرئيسي للـ Go Worker
compatibility_date = "2025-12-09" # تاريخ التوافق مع Workers
# Go لا يحتاج nodejs_compat
# compatibility_flags = ["nodejs_compat"] 

type = "javascript" # رغم أننا نستخدم Go، هذا يُبقى wrangler متوافقًا مع Workers

# ========== بيئات التطوير والإنتاج ==========
[env.development]
name = "nawthtech-api-dev"
vars = { 
  ENVIRONMENT = "development",
  API_VERSION = "v1",
  D1_DATABASE_URL = "file:dev.db" , # يمكن تغييره لاحقًا لمسار DB المحلي
  CORS_ALLOWED_ORIGINS = "http://localhost:3000,http://localhost:5173,http://127.0.0.1:3000,http://127.0.0.1:5173"
}

[env.production]
name = "nawthtech-api"
vars = { 
  ENVIRONMENT = "production",
  API_VERSION = "v1",
  D1_DATABASE_URL = "file:prod.db", # سيتم ربطه مع D1 Cloudflare
  CORS_ALLOWED_ORIGINS = "https://nawthtech.com,https://www.nawthtech.com,https://api.nawthtech.com,https://storage.nawthtech.com"
}

# ========== D1 Database ==========
[[d1_databases]]
binding = "D1"             # هذا الاسم سيتم استخدامه في الكود Go
database_name = "nawthtech_d1" # اسم قاعدة البيانات على D1
database_id = "bbf15aeb-0718-47c8-9723-d8a83f79e6cb" # استبدلها بالـ ID من Cloudflare
preview_database_name = "nawthtech_dev" # نسخة التطوير
preview_database_id = "your-d1-preview-id-here" # ID نسخة التطوير

# ========== Secrets ==========
[[secrets_stores]]
binding = "SECRETS"
id = "a6428db8d5304ba0a48ee7009cc18ded" # معرف الـ Secret Store